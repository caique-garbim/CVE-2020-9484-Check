#!/bin/bash

if [ $# -ne 1 ]; then
	echo " "
	echo "     CVE-2020-9484-Check"
	echo " "
	echo " Usage:"
	echo " ./$0 http://target:8080/"
	exit 1
fi

for path in $(cat paths.txt); do
  if [ $(curl -s --connect-timeout 3.37 -sL -w '%{http_code}' $1/index.jsp -H "Cookie: JSESSIONID=$path" -o /dev/null) == "500" ]
  then
    if [ $(curl -s --connect-timeout 3.37 "$1/index.jsp" -H "Cookie: JSESSIONID=$path" | grep -oh "java" | sort -u) == "java" ]
    then
      echo -e "$1 [+] VULNERABLE"
    else
      echo -e "$1 RESEPONSE500"
    fi
  else
    echo -e "$1 [!] NOT VULNERABLE"
  fi
done
