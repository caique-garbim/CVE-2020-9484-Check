#!/bin/bash

for path in $(cat paths.txt); do
  if [ $(curl --connect-timeout 3.37 -sL -w '%{http_code}' $1/index.jsp -H "Cookie: JSESSIONID=$path" -o /dev/null) == "500" ]
  then
    if [ $(curl --connect-timeout 3.37 "$1/index.jsp" -H "Cookie: JSESSIONID=$path" | grep -oh "java" | sort -u) == "java" ]
    then
      echo -e "$1 SUCCESS"
    else
      echo -e "$1 RESEPONSE500"
    fi
  else
    echo -e "$1 xNOTVULNERABLE"
  fi
done
